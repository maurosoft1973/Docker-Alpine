name: Build and Execute DockerAlpine
on:
  push:
    branches: [main,master]
    paths:  [ 'src/**', 'Directory.Packages.props' ]
  pull_request:
    branches: [main,master]
    paths:  [ 'src/**' ]
  workflow_dispatch:
    inputs:
      configuration:
        type: choice
        description: The build configuration to use in the deploy stage.
        required: true
        default: Release
        options:
          - Debug
          - Release

env:
  TIMEZONE: 'Europe/Rome'
  CONFIGURATION: 'Release'
  PROJECT_PATH: src/DockerAlpine
  PROJECT_NAME: DockerAlpine.csproj
  PROJECT_BUILD: DockerAlpine.dll

jobs:
  build:
    name: üõ†Ô∏è Build
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: maurosoft1973/gha-git-checkout@v1

      - name: Install .NET
        uses: maurosoft1973/gha-dotnet-install@v1
        with:
          includeEndOfFileVersion: true

      - name: Restore Dependencies
        uses: maurosoft1973/gha-dotnet-restore@v1

      - name: Build for ${{ env.PROJECT_NAME }} (${{ env.CONFIGURATION }})
        run:
            dotnet build ${{ env.PROJECT_PATH }}/${{ env.PROJECT_NAME }} --configuration ${{ env.CONFIGURATION }} --no-restore --verbosity minimal --output ./artifacts/

      - name: Execute for ${{ env.PROJECT_NAME }} (${{ env.CONFIGURATION }})
        run:
            dotnet run ./artifacts/${{ env.PROJECT_BUILD }}
